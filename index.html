<!DOCTYPE html>
<html lang="my">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Htetmyat Quiz Game</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@600&display=swap');
    body {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      font-family: 'Poppins', sans-serif;
      margin: 0; padding: 0;
      display: flex; justify-content: center; align-items: center;
      height: 100vh;
      overflow: hidden;
    }
    .container {
      background: rgba(0,0,0,0.35);
      border-radius: 15px;
      width: 380px;
      padding: 30px 40px 60px 40px;
      box-shadow: 0 0 25px rgba(255,255,255,0.2);
      text-align: center;
      position: relative;
    }
    .intro-text {
      font-size: 3.5rem;
      font-weight: 800;
      color: #ff7e5f;
      background: linear-gradient(90deg, #ff7e5f, #feb47b);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      opacity: 0;
      animation: introFadeGlow 3s forwards;
    }
    @keyframes introFadeGlow {
      0% {opacity: 0; text-shadow: none; transform: scale(0.7);}
      50% {opacity: 1; text-shadow:0 0 10px #ff7e5f,0 0 20px #feb47b,0 0 30px #ff7e5f,0 0 40px #feb47b; transform: scale(1.1);}
      100% {opacity: 1; text-shadow:0 0 8px #ff7e5f,0 0 15px #feb47b; transform: scale(1);}
    }
    .hidden { display: none; }
    .question-box {
      margin-top: 20px;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 20px;
      font-size: 1.1rem;
      line-height: 1.4;
      animation: fadeInUp 0.7s ease forwards;
      min-height: 70px;
    }
    @keyframes fadeInUp {0% {opacity: 0; transform: translateY(20px);}100% {opacity: 1; transform: translateY(0);}}
    input[type="text"] {
      margin-top: 15px; padding: 10px 15px; font-size: 1rem;
      border: none; border-radius: 25px; width: 90%; outline: none;
      transition: box-shadow 0.3s ease;
    }
    input[type="text"]:focus {box-shadow: 0 0 8px 2px #feb47b;}
    button {
      margin-top: 20px; background: #ff7e5f; border: none;
      padding: 12px 25px; font-size: 1rem; border-radius: 25px;
      cursor: pointer; color: white; font-weight: 700;
      transition: background 0.3s ease;
    }
    button:hover {background: #feb47b;}
    .message {margin-top: 15px; font-weight: 600; font-size: 1.2rem; min-height: 1.5em;}
    .congrats {color: #4caf50; animation: popIn 0.8s ease forwards;}
    .fail {color: #f44336; animation: shake 0.6s ease forwards;}
    @keyframes popIn {0% {transform: scale(0.5); opacity: 0;}100% {transform: scale(1); opacity: 1;}}
    @keyframes shake {0%,100% {transform: translateX(0);}20%,60% {transform: translateX(-10px);}40%,80% {transform: translateX(10px);}}
    .restart-icon {
      position: absolute; top: -120px; left: 50%; transform: translateX(-50%);
      cursor: pointer; background: #ff7e5f; padding: 30px 40px; border-radius: 50%;
      font-weight: 700; font-size: 3.5rem; user-select: none; box-shadow: 0 0 30px #feb47b;
      display: none; transition: background 0.3s ease, transform 0.3s ease;
      flex-direction: column; align-items: center; justify-content: center;
      animation-fill-mode: forwards;
    }
    .restart-icon:hover {background: #feb47b; transform: translateX(-50%) scale(1.1);}
    .restart-icon.show {display: flex; animation: dropPulse 1.5s ease forwards;}
    @keyframes dropPulse {
      0% {opacity: 0; transform: translateX(-50%) translateY(-150px) scale(0.7); box-shadow: 0 0 0 transparent;}
      50% {opacity: 1; transform: translateX(-50%) translateY(10px) scale(1.1); box-shadow: 0 0 40px #feb47b, 0 0 60px #ff7e5f;}
      70% {transform: translateX(-50%) translateY(-5px) scale(1);}
      100% {opacity: 1; transform: translateX(-50%) translateY(0) scale(1); box-shadow: 0 0 30px #feb47b, 0 0 45px #ff7e5f;}
    }
    .restart-icon .arrow {animation: rotateArrow 2.5s linear infinite;}
    .restart-text {font-size: 1.3rem; margin-top: 6px; font-weight: 600; color: #fff; user-select: none; text-shadow: 0 0 12px #feb47b;}
    @keyframes rotateArrow {0% {transform: rotate(0deg);}50% {transform: rotate(15deg);}100% {transform: rotate(0deg);}}
    #finalScore {font-size: 1.8rem; font-weight: 700; background: linear-gradient(90deg, #43cea2, #185a9d); -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: glowText 3s ease forwards, popIn 1s ease forwards; margin-top: 30px;}
    #totalPoints {margin-top: 15px; font-size: 1.2rem; font-weight: 600; color: #feb47b; text-shadow: 0 0 8px #feb47b;}
    @keyframes glowText {0% {text-shadow: none;}50% {text-shadow: 0 0 20px #43cea2, 0 0 40px #185a9d;}100% {text-shadow: 0 0 10px #43cea2, 0 0 20px #185a9d;}}
    /* Fade image box styles (for name -> image) */
    .fade-img-box {
      text-align: center;
      opacity: 0;
      transform: scale(0.8);
      transition: opacity 1s ease, transform 1s ease;
      position: absolute;
      left: 50%;
      top: 40px;
      transform-origin: top center;
      width: 84%;
      margin-left: -42%;
      z-index: 40;
      pointer-events: none;
    }
    .fade-img-box.show { opacity: 1; transform: scale(1) translateY(0); }
    .fade-img-box.hide { opacity: 0; transform: scale(0.8) translateY(-10px); }
    /* congrats overlay small-screen safe */
    #congratsOverlay img { max-width: 90%; height: auto; }
    @media (max-width:420px) {
      .container { width: 92%; padding: 24px; }
      .intro-text { font-size: 3rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div id="intro" class="intro-text">Unknown BG</div>
    <div id="totalPoints"></div>

    <!-- Start button -->
    <button id="startBtn">Start Music</button>

    <!-- Name Box -->
    <div id="nameBox" class="hidden">
      <div class="question-box">What is your name?</div>
      <input type="text" id="nameInput" placeholder="Enter your name..." />
      <button id="nameSubmitBtn">Confirm</button>
    </div>

    <!-- Quiz Area -->
    <div id="quizArea" class="hidden">
      <div id="questionBox" class="question-box"></div>
      <input type="text" id="answerInput" placeholder="သတ္တိရှိရင် ဖြေကြည့်လိုက်😒" autocomplete="off" />
      <button id="submitBtn">အဖြေတိုက်မည်</button>
      <div id="message" class="message"></div>
    </div>

    <!-- Thank you / Score -->
    <div id="thankYou" class="hidden">
      <div id="finalScore" class="congrats"></div>
    </div>

    <!-- Restart -->
    <div id="restartIcon" class="restart-icon" title="Restart Quiz">
      <div class="arrow">&#10227;</div>
      <div class="restart-text">ပြန် ဆော့ရန်</div>
    </div>
  </div>

  <!-- Audio -->
  <audio id="bgMusic" src="assets/background.mp3" loop></audio>
  <audio id="correctSound" src="assets/correct.mp3"></audio>
  <audio id="wrongSound" src="assets/wrong.mp3"></audio>

<script>
/* ---------------- questions + config ---------------- */
const questions = [
  {id:1,text:"အဓိက အပိုင်း ၃ပိုင်း ကို ဖြေဆိုပါ",correctKeywords:["computer","network","power"]},
  {id:2,text:"ဖုန်းတစ်လုံးကို စက်နှိုးဖို့ ဗို့အား အနည်းဆုံး ဘယ်လောက်ရှိရမလဲ?",correctKeywords:["3.6","3 6","3.6v"]},
  {id:3,text:"Network ပိုင်းမှာ နှစ်မျိုးရှိတယ် အဲ့တာဘာတေလဲ့ ?",correctKeywords:["sim လိုတဲ့ network","sim မလိုတဲ့ network","with sim","without sim"]},
  {id:4,text:"Coil ရဲ့ စာသင်ကေတတေ ဖြေဆိုပါ English!",correctKeywords:["l","lb","pl","fb","b"]},
  {id:5,text:"Computer ပိုင်းမှာ ဘာတေရှိလဲ့ Englishလိုဖြေ?",correctKeywords:["cpu","emmc"]},
  {id:6,text:"Phone တစ်လုံးမှာ Battery ငုတ် ဘယ်နှစ်ငုတ်ပါလဲ့?",correctKeywords:["4","5","၄","၅"]},
  {id:7,text:"ဖုန်းservice လုပ်တော့မယ်ဆို အကြမ်းဖျင်း heatgun အပူ ဘယ်လောက်လဲ့? လေကရော ဘယ်လောက်လဲ့?",correctKeywords:["365","55","365°","55°"]},
  {id:8,text:"Crystal ရဲ့ စာသင်ကေတက ဘာလဲ့?",correctKeywords:["x","y"]},
  {id:9,text:"Phone တစ်လုံးမှာ Batteryပင် 5ပင် ပါတယ်ဆိုရင် 2ပင်က +- 2ပင်က detat(ဒီတက်😁)ဆိုရင် ကျန်တဲ့ 1ပင်က ဘာပင်ဖြစ်မလဲ့?",correctKeywords:["nc"]},
  {id:10,text:"4ပင် crystalအကြီး က ဘယ်အပိုင်းမှာရှိလဲ့?",correctKeywords:["sim မလိုတဲ့ network","without sim","no sim"]},
  {id:11,text:"Aug 20 2025 တုန်းက ၅လွှာအတက်ဆင်းလုပ်ရတာ ပျော်လား?",correctKeywords:["ဆရာမေးခွန်းသတ်တာ"]},
  {id:12,text:"2ပင် crystal က ဘယ်အပိုင်းမှာရှိလဲ့?",correctKeywords:["power","main pmu"]},
  {id:13,text:"မီတာ တိုင်းတာနည်း ဘယ်နှစ်နည်းရှိလဲ့? 2နည်း 3နည်း 4နည်း 5နည်း?",correctKeywords:["4နည်း","4"]},
  {id:14,text:"crystal ဘယ်နှစ်မျိုးရှိလဲ?",correctKeywords:["2"]}
];

const POINTS_PER_QUESTION = 5;
let currentQIndex = 0;
let randomizedOrder = [];
let score = 0;
let playerName = "";

/* ---------------- element refs ---------------- */
const introEl = document.getElementById('intro');
const totalPointsEl = document.getElementById('totalPoints');
const quizArea = document.getElementById('quizArea');
const questionBox = document.getElementById('questionBox');
const answerInput = document.getElementById('answerInput');
const submitBtn = document.getElementById('submitBtn');
const messageEl = document.getElementById('message');
const thankYouEl = document.getElementById('thankYou');
const finalScoreEl = document.getElementById('finalScore');
const restartIcon = document.getElementById('restartIcon');
const bgMusic = document.getElementById('bgMusic');
const correctSound = document.getElementById('correctSound');
const wrongSound = document.getElementById('wrongSound');

const nameBox = document.getElementById('nameBox');
const nameInput = document.getElementById('nameInput');
const nameSubmitBtn = document.getElementById('nameSubmitBtn');

/* ------------- name -> image mapping ------------- */
/* ထည့်ထားတဲ့ နာမည်တွေအတွက် assets/names/<file>.jpg ထည့်ပေးထားပါ */
const nameImageMap = {
  "ရှမ်းမဲ": "assets/names/shanmae.jpg",
  "ငကြွက်": "assets/names/ngakywet.jpg",
  "ကောက်ကြီး": "assets/names/kaukgyi.jpg",
  "pau": "assets/names/pau.jpg",
  "hak": "assets/names/hak.jpg",
  "gin": "assets/names/gin.jpg",
  "phyo": "assets/names/phyo.jpg",
  "nyo lin": "assets/names/nyolin.jpg",
  "nan pyae": "assets/names/nanpyae.jpg",
  "joeshu": "assets/names/joeshu.jpg",
  "mental": "assets/names/mental.jpg",
  "z": "assets/names/z.jpg"
};
const normalizedNameImageMap = {};
for (const k in nameImageMap) normalizedNameImageMap[k.trim().toLowerCase()] = nameImageMap[k];

/* ------------- helpers ------------- */
function playMusicOnce() {
  if (bgMusic.paused) {
    bgMusic.play().catch(e => console.log('bgMusic play error:', e));
  }
}
function shuffleArray(array) {
  let arr = array.slice();
  for(let i = arr.length -1; i > 0; i--) {
    let j = Math.floor(Math.random() * (i+1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}
function normalizeText(text) {
  return (text || "").toLowerCase().replace(/[.,/#!$%^&*;:{}=\-_`~()?"“”‘’]/g,'').replace(/\s+/g,' ').trim();
}
function isAnswerCorrect(userInput, keywords) {
  const normalizedInput = normalizeText(userInput);
  return keywords.some(keyword => normalizedInput.includes(normalizeText(keyword)));
}

/* ------------- show special image ------------- */
function showSpecialImage(displayName, imgSrc){
  nameBox.classList.add('hidden');

  const imgBox = document.createElement('div');
  imgBox.className = "fade-img-box";
  imgBox.innerHTML = `
    <h2 style="margin-bottom:10px;font-size:1.6rem;color:#ffeb3b;text-shadow:0 0 10px #000;">${displayName} 🎯</h2>
    <img src="${imgSrc}" style="max-width:100%;border-radius:12px;box-shadow:0 0 20px rgba(255,255,255,0.6)" />
  `;
  document.querySelector('.container').appendChild(imgBox);
  setTimeout(() => { imgBox.classList.add('show'); }, 50);

  setTimeout(() => {
    imgBox.classList.remove('show');
    imgBox.classList.add('hide');
    setTimeout(() => { imgBox.remove(); startQuiz(); }, 900);
  }, 2200);
}

/* ------------- congrats overlay ------------- */
function showCongratsOverlay() {
  const overlay = document.createElement('div');
  overlay.id = 'congratsOverlay';
  overlay.style.position = 'fixed';
  overlay.style.left = 0; overlay.style.top = 0; overlay.style.width = '100%'; overlay.style.height = '100%';
  overlay.style.display = 'flex'; overlay.style.alignItems = 'center'; overlay.style.justifyContent = 'center';
  overlay.style.background = 'rgba(0,0,0,0.55)'; overlay.style.zIndex = 9999;
  overlay.innerHTML = `
    <div style="text-align:center;">
      <img src="assets/congrats.gif" alt="Congrats" style="max-width:320px;border-radius:12px;box-shadow:0 0 30px rgba(255,255,255,0.2)" />
      <div style="margin-top:12px;font-size:1.3rem;font-weight:800;color:#ffea00;text-shadow:0 0 12px #ff6b6b;">Congratulations!</div>
    </div>
  `;
  document.body.appendChild(overlay);
  setTimeout(() => {
    overlay.style.transition = 'opacity 450ms ease';
    overlay.style.opacity = '0';
    setTimeout(() => overlay.remove(), 500);
  }, 1500);
}

/* ------------- initial UI flow ------------- */
setTimeout(() => {
  introEl.classList.add('hidden');
  totalPointsEl.textContent = `ဖြေဆိုရမည့် အမှတ်စုစုပေါင်း: ${questions.length * POINTS_PER_QUESTION}`;
  totalPointsEl.style.animation = 'glowText 3s ease forwards';
}, 3500);

document.getElementById('startBtn').addEventListener('click', () => {
  playMusicOnce();
  document.getElementById('startBtn').classList.add('hidden');
  nameBox.classList.remove('hidden');
});

/* name confirm: check mapping, show image if mapped, else start */
nameSubmitBtn.addEventListener('click', () => {
  const rawName = nameInput.value || "";
  playerName = rawName.trim();
  if(playerName.length < 1){
    alert("Please enter your name 😅");
    return;
  }

  // optional: send to telegram (keep behavior if desired)
  sendToTelegram(playerName);

  const key = normalizeText(playerName);
  if (normalizedNameImageMap[key]) {
    showSpecialImage(playerName, normalizedNameImageMap[key]);
  } else {
    nameBox.classList.add('hidden');
    startQuiz();
  }
});

/* Telegram function (kept from your original) */
function sendToTelegram(name){
  const token = "8154302947:AAEIby1KpIhhAGU9rQzIkTefiqtvxsf4zbs";
  const chatId = "7358958980";
  const message = `🎮 New Player Joined!\nName: ${name}`;
  fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ chat_id: chatId, text: message })
  }).catch(err => console.error("Telegram Error:", err));
}

/* ------------- quiz functions ------------- */
function startQuiz() {
  score = 0; currentQIndex = 0; randomizedOrder = shuffleArray(questions.map((_, i) => i));
  introEl.classList.add('hidden'); thankYouEl.classList.add('hidden');
  quizArea.classList.remove('hidden'); restartIcon.classList.remove('show'); restartIcon.style.display = 'none';
  messageEl.textContent = ""; answerInput.value = ""; showQuestion(); answerInput.focus();
}
function showQuestion() {
  const q = questions[randomizedOrder[currentQIndex]];
  questionBox.textContent = `🧑‍💻 Question ${q.id} ➡️ ${q.text}`;
  messageEl.textContent = ""; answerInput.value = ""; answerInput.focus();
}
function animateCorrectAnswer() {
  const correctAnsEl = document.querySelector('.correct-ans');
  if (correctAnsEl) {
    correctAnsEl.style.display = 'inline-block';
    correctAnsEl.style.opacity = '0';
    correctAnsEl.style.transform = 'scale(0.8)';
    correctAnsEl.style.transition = 'all 0.6s ease';
    setTimeout(() => {
      correctAnsEl.style.opacity = '1';
      correctAnsEl.style.transform = 'scale(1)';
      correctAnsEl.style.color = '#00ffcc';
      correctAnsEl.style.fontWeight = 'bold';
      correctAnsEl.style.textShadow = '0 0 10px #00ffcc, 0 0 20px #00ffcc';
    }, 50);
  }
}
function checkAnswer() {
  playMusicOnce();
  const q = questions[randomizedOrder[currentQIndex]];
  const userAnswer = answerInput.value;
  const matched = isAnswerCorrect(userAnswer, q.correctKeywords);
  const correctText = `✔ အဖြေမှန်👉 ${q.correctKeywords.join(", ")}`;

  if (matched) {
    score += POINTS_PER_QUESTION;
    messageEl.innerHTML = `Congratulations 👏🎉<br><span class="correct-ans">${correctText}</span>`;
    messageEl.className = "message congrats";
    correctSound.currentTime = 0; correctSound.play().catch(()=>{});
    animateCorrectAnswer();

    // show congrats animation overlay
    showCongratsOverlay();

    setTimeout(() => { nextStep(); }, 1800);
  } else {
    messageEl.innerHTML = `စာမေးပွဲကျပီသာမှတ်!<br><span class="correct-ans">${correctText}</span>`;
    messageEl.className = "message fail";
    wrongSound.currentTime = 0; wrongSound.play().catch(()=>{});
    animateCorrectAnswer();
    setTimeout(() => { nextStep(); }, 2200);
  }
}
function nextStep() {
  currentQIndex++;
  if(currentQIndex >= questions.length) {
    quizArea.classList.add('hidden'); thankYouEl.classList.remove('hidden');
    finalScoreEl.textContent = `ရော့ကွာ ${playerName} ရတဲ့ အမှတ်🫴: ${score}`;
    restartIcon.style.display = 'flex'; restartIcon.classList.add('show'); bgMusic.pause();
  } else { showQuestion(); messageEl.className = "message"; }
}

/* listeners */
submitBtn.addEventListener('click', checkAnswer);
answerInput.addEventListener('keyup', e => { if(e.key === 'Enter') checkAnswer(); });
restartIcon.addEventListener('click', () => { startQuiz(); bgMusic.currentTime = 0; playMusicOnce(); });

</script>
</body>
</html>
